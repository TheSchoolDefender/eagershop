<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<title>MOST PEAK WEBSITE EVER</title>
<style>
:root {
  --dark-green: #1a472a;
  --metallic-orange: #d4802c;
  --gray: #808080;
  --metallic-gray: #a8a9ad;
  --navy-blue: #1B2A4A;
}

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--navy-blue);
  color: white;
  overflow: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--metallic-orange) var(--navy-blue);
}

body::-webkit-scrollbar {
  width: 6px;
}

body::-webkit-scrollbar-track {
  background: rgba(27, 42, 74, 0.5);
}

body::-webkit-scrollbar-thumb {
  background: var(--metallic-orange);
  border-radius: 10px;
}

body::-webkit-scrollbar-thumb:hover {
  background: #ff9933;
  cursor: pointer;
}

.sidebar {
  height: 100vh;
  overflow-y: auto;
  width: 240px;
  position: fixed;
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  padding: 20px;
  box-shadow: 5px 0 15px rgba(0,0,0,0.3);
  animation: sidebarGlow 2s infinite alternate;
}

@keyframes sidebarGlow {
  from { box-shadow: 0 0 10px var(--metallic-orange); }
  to { box-shadow: 0 0 20px var(--metallic-orange); }
}

.sidebar a {
  display: flex;
  align-items: center;
  gap: 15px;
  color: white;
  padding: 20px;
  text-decoration: none;
  margin: 15px 0;
  background: linear-gradient(to right, var(--navy-blue), rgba(27, 42, 74, 0.7));
  border-radius: 12px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  font-size: 18px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  border: 2px solid transparent;
}

.sidebar a:hover {
  border-color: var(--metallic-orange);
  transform: translateX(10px);
  background: linear-gradient(to right, var(--navy-blue), var(--dark-green));
}

.sidebar a i {
  font-size: 24px;
  color: var(--metallic-orange);
}

.content {
  margin-left: 280px;
  padding: 40px;
  min-height: 100vh;
}

.welcome {
  text-align: center;
  margin-top: 50px;
  animation: fadeIn 1s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

.welcome h1 {
  font-size: 64px;
  color: var(--metallic-orange);
  text-shadow: 3px 3px var(--metallic-gray), 6px 6px rgba(0,0,0,0.2);
  font-weight: 800;
  letter-spacing: 2px;
  margin-bottom: 30px;
}

.welcome p {
  font-size: 20px;
  color: var(--metallic-gray);
  line-height: 1.6;
  max-width: 800px;
  margin: 0 auto;
}

.username-form {
  text-align: center;
  margin-top: 50px;
  padding: 30px;
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  backdrop-filter: blur(5px);
}

.username-form input {
  padding: 15px 25px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: var(--metallic-gray);
  color: var(--dark-green);
  margin-right: 10px;
  outline: none;
  transition: all 0.3s ease;
}

.username-form button {
  padding: 15px 30px;
  font-size: 18px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
}

.username-form button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

#wheel {
  position: relative;
  width: 100%;
  min-height: 100vh;
  display: block;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--navy-blue);
  margin-bottom: 60px; /* Space between wheel and shop section */
}

#shop {
  display: block;
  margin-bottom: 100px;
}

#buy {
  display: block;
  margin-bottom: 100px;
}

.bet-container {
  position: relative; /* Change from fixed to relative */
  bottom: auto; /* Remove fixed bottom */
  left: auto; /* Remove fixed left */
  transform: none; /* Remove transform */
  margin: 40px auto; /* Add margin for spacing */
  background: var(--navy-blue);
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  border: 2px solid var(--metallic-orange);
  z-index: 100;
  width: 80%;
  max-width: 500px;
  display: flex;
  justify-content: center;
  gap: 20px;
}

#bet-amount {
  padding: 20px;
  font-size: 24px;
  border: none;
  border-radius: 12px;
  background: rgba(255,255,255,0.95);
  color: var(--dark-green);
  width: 200px;
  text-align: center;
  box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
}

.bet-container button {
  padding: 20px 40px;
  font-size: 24px;
  background: var(--navy-blue);
  border: none;
  border-radius: 12px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
  letter-spacing: 2px;
}

.bet-container button:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  background: var(--metallic-orange);
}

.emoji-spinner {
  display: flex;
  justify-content: center;
  gap: 20px;
  font-size: 48px;
  margin: 30px 0; /* Reduce top margin since bet container will be below */
}

.emoji-box {
  width: 100px;
  height: 100px;
  font-size: 60px;
  background: linear-gradient(135deg, var(--metallic-gray), var(--navy-blue));
  border-radius: 15px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.hidden {
  display: none;
}

.buy-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  padding: 20px;
  overflow-x: auto;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE and Edge */
}

/* Hide scrollbar for Chrome, Safari and Opera */
.buy-container::-webkit-scrollbar {
  display: none;
}

.buy-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  padding: 30px;
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  border-radius: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  border: 2px solid var(--metallic-orange);
  transition: all 0.3s ease;
}

.buy-option:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(212, 128, 44, 0.3);
}

.buy-option img {
  width: 120px;
  height: 120px;
  object-fit: contain;
}

.buy-option span {
  font-size: 24px;
  color: var(--metallic-orange);
  font-weight: bold;
}

.buy-option button {
  padding: 15px 30px;
  font-size: 18px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
  letter-spacing: 1px;
}

.buy-option button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px var(--metallic-orange);
}

.shop-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 20px;
  padding: 20px;
}

.prestige-rank {
  background: linear-gradient(45deg, var(--navy-blue), #0d1525) !important;
  border: 2px solid var(--metallic-orange) !important;
  transform-style: preserve-3d;
  transition: all 0.3s ease-in-out !important;
}

.prestige-rank:hover {
  transform: translateY(-10px) rotate3d(1, 1, 0, 15deg) !important;
  box-shadow: 0 15px 30px rgba(212, 128, 44, 0.3) !important;
}

.prestige-rank .emoji {
  font-size: 64px !important;
  margin: 20px 0;
  animation: float 3s ease-in-out infinite;
}

.prestige-rank h3 {
  color: var(--metallic-orange);
  font-size: 24px;
  margin: 10px 0;
  text-transform: uppercase;
  letter-spacing: 2px;
}

.prestige-rank p {
  color: var(--metallic-gray);
  margin: 10px 0;
}

.prestige-rank .price {
  font-size: 22px;
  font-weight: bold;
  color: #fff;
  text-shadow: 0 0 10px var(--metallic-orange);
}

.rank-button {
  background: linear-gradient(45deg, var(--metallic-orange), #ff9933) !important;
  border: none;
  padding: 15px 30px !important;
  border-radius: 25px !important;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  transition: all 0.3s ease !important;
}

.rank-button:hover {
  transform: scale(1.1) !important;
  box-shadow: 0 0 20px var(--metallic-orange) !important;
}

@keyframes float {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
}

/* Add a special animation for purchase success */
@keyframes purchaseSuccess {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.purchase-success {
  animation: purchaseSuccess 0.5s ease;
}

.shop-item {
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  padding: 20px;
  border-radius: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  border: 2px solid var(--metallic-gray);
}

.shop-item:hover {
  transform: translateY(-5px);
  border-color: var(--metallic-orange);
}

.shop-item .emoji {
  font-size: 48px;
  margin-bottom: 10px;
}

.shop-item .price {
  color: var(--metallic-orange);
  font-weight: bold;
}

.shop-item button {
  padding: 10px 20px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
}

.shop-item button:hover {
  transform: scale(1.05);
}

.section-title {
  font-size: 48px;
  color: var(--metallic-orange);
  text-align: center;
  margin-bottom: 60px;
  text-transform: uppercase;
  text-shadow: 3px 3px var(--metallic-gray), 6px 6px rgba(0,0,0,0.2);
  font-weight: 800;
  letter-spacing: 2px;
}

.welcome-back {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--navy-blue);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeOut 2s forwards;
  animation-delay: 3s;
}

.welcome-back h1 {
  font-size: 48px;
  color: var(--metallic-orange);
  text-align: center;
  margin-bottom: 20px;
  text-shadow: 3px 3px var(--metallic-gray);
  animation: bounce 1s infinite alternate;
}

.welcome-back p {
  font-size: 24px;
  color: white;
  text-align: center;
  max-width: 600px;
  line-height: 1.6;
  margin: 0 auto;
  padding: 0 20px;
}

.stars {
  position: absolute;
  font-size: 24px;
  animation: twinkle 1.5s infinite alternate;
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; visibility: hidden; }
}

@keyframes bounce {
  from { transform: translateY(0); }
  to { transform: translateY(-10px); }
}

@keyframes twinkle {
  from { opacity: 0.3; }
  to { opacity: 1; }
}

.battle-pass {
  display: flex;
  gap: 30px;
  padding: 40px;
  overflow-x: auto;
  align-items: center;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.battle-pass::-webkit-scrollbar {
  display: none;
}

.battle-pass-item {
  min-width: 150px;
  height: 150px;
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  border-radius: 15px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  cursor: pointer;
  border: 2px solid var(--metallic-gray);
  transition: all 0.3s ease;
  position: relative;
}

.battle-pass-item.completed {
  border-color: #4CAF50;
  background: linear-gradient(135deg, #1a472a, #0d1525);
}

.battle-pass-item.locked {
  opacity: 0.7;
  cursor: not-allowed;
}

.battle-pass-item:hover:not(.locked) {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(212, 128, 44, 0.3);
}

.item-info {
  text-align: center;
}

.item-emoji {
  font-size: 48px;
  margin-bottom: 10px;
}

.item-details {
  text-align: center;
}

.item-details h3 {
  font-size: 16px;
  color: var(--metallic-orange);
  margin: 0;
}

.item-price {
  font-size: 14px;
  color: var(--metallic-gray);
  margin-top: 5px;
}

.level-indicator {
  position: absolute;
  top: 10px;
  left: 10px;
  background: var(--metallic-orange);
  color: white;
  font-size: 12px;
  padding: 3px 8px;
  border-radius: 10px;
}

.blackjack-table {
  display: flex;
  flex-direction: column;
  gap: 30px;
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.dealer-cards, .player-cards {
  background: rgba(255, 255, 255, 0.05);
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(8px);
}

.dealer-cards h2, .player-cards h2 {
  color: var(--metallic-orange);
  font-size: 24px;
  margin-bottom: 20px;
  text-transform: uppercase;
  letter-spacing: 2px;
}

.cards-container {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.card {
  width: 120px;
  height: 180px;
  background: linear-gradient(135deg, var(--metallic-gray), #fff);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  font-weight: bold;
  color: var(--navy-blue);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  position: relative;
  transition: transform 0.3s ease;
  animation: cardDeal 0.5s ease-out;
}

.card.hidden {
  background: linear-gradient(135deg, var(--navy-blue), var(--dark-green));
  color: transparent;
}

.card:hover {
  transform: translateY(-5px);
}

@keyframes cardDeal {
  from {
    transform: translateY(-100px) rotate(-10deg);
    opacity: 0;
  }
  to {
    transform: translateY(0) rotate(0);
    opacity: 1;
  }
}

.blackjack-controls {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  margin-top: 20px;
}

#blackjack-bet {
  padding: 15px;
  width: 200px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.9);
  color: var(--navy-blue);
  text-align: center;
}

.action-buttons {
  display: flex;
  gap: 20px;
}

.action-buttons button, #deal-button {
  padding: 15px 40px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: var(--metallic-orange);
  color: white;
  cursor: pointer;
  text-transform: uppercase;
  font-weight: bold;
  letter-spacing: 1px;
  transition: all 0.3s ease;
}

.action-buttons button:hover, #deal-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(212, 128, 44, 0.3);
}

#blackjack-result {
  text-align: center;
  font-size: 24px;
  font-weight: bold;
  color: var(--metallic-orange);
  margin-top: 20px;
  animation: resultPop 0.5s ease-out;
}

@keyframes resultPop {
  from {
    transform: scale(0.8);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

#player-total {
  color: var(--metallic-gray);
  font-size: 20px;
  text-align: center;
  margin-top: 15px;
}

#streak {
  padding: 40px;
  text-align: center;
}

.streak-card {
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  border-radius: 15px;
  padding: 30px;
  max-width: 400px;
  margin: 0 auto;
  border: 2px solid var(--metallic-orange);
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.streak-info {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  margin: 20px 0;
}

.streak-count {
  font-size: 48px;
  font-weight: bold;
  color: var(--metallic-orange);
  text-shadow: 0 0 10px rgba(212, 128, 44, 0.5);
}

.streak-flame {
  font-size: 48px;
  animation: flameFlicker 1.5s ease-in-out infinite alternate;
}

@keyframes flameFlicker {
  0% { transform: scale(1) rotate(-5deg); }
  100% { transform: scale(1.1) rotate(5deg); }
}

.streak-button {
  background: var(--metallic-orange);
  border: none;
  padding: 15px 30px;
  font-size: 18px;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
  letter-spacing: 1px;
}

.streak-button:hover:not(:disabled) {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(212, 128, 44, 0.3);
}

.streak-button:disabled {
  background: var(--gray);
  cursor: not-allowed;
  opacity: 0.7;
}

.next-reward {
  margin-top: 20px;
  color: var(--metallic-gray);
  font-size: 16px;
}

/* Redeem Code Section Styles */
.redeem-code-section {
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  padding: 30px;
  border-radius: 15px;
  margin: 20px 0 40px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  border: 2px solid var(--metallic-orange);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.redeem-code-section h2 {
  color: var(--metallic-orange);
  font-size: 24px;
  margin-bottom: 20px;
  text-align: center;
}

.redeem-controls {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin-bottom: 15px;
}

#gift-code {
  padding: 15px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: rgba(255,255,255,0.95);
  color: var(--dark-green);
  width: 200px;
  text-align: center;
}

.redeem-controls button {
  padding: 15px 30px;
  font-size: 18px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
}

.redeem-controls button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(212, 128, 44, 0.3);
}

#redeem-status {
  text-align: center;
  margin-top: 15px;
  font-weight: bold;
  min-height: 24px;
}

/* Crates Section Styles */
.crates-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 30px;
  padding: 20px;
}

.crate {
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  padding: 30px;
  border-radius: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  border: 2px solid var(--metallic-orange);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.crate:hover {
  transform: translateY(-5px);
}

.crate .emoji {
  font-size: 48px;
  margin-bottom: 10px;
}

.crate h3 {
  color: var(--metallic-orange);
  font-size: 24px;
  margin: 0;
}

.crate p {
  color: var(--metallic-gray);
  text-align: center;
  margin: 0;
}

.crate .price {
  font-size: 20px;
  font-weight: bold;
  color: white;
}

.crate button {
  padding: 15px 30px;
  font-size: 18px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
}

.crate button:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px var(--metallic-orange);
}

.crate.opening::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
  animation: shine 0.5s ease-out;
}

@keyframes shine {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

/* Slots Section Styles */
.slot-machine {
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  padding: 40px;
  border-radius: 20px;
  max-width: 600px;
  margin: 0 auto;
  box-shadow: 0 15px 30px rgba(0,0,0,0.3);
  border: 2px solid var(--metallic-orange);
}

.slot-reels {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 30px;
}

.slot-reel {
  width: 120px;
  height: 120px;
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  border: 2px solid var(--metallic-gray);
}

.reel-content {
  transition: all 0.1s ease;
}

.slot-controls {
  display: flex;
  gap: 20px;
  justify-content: center;
  margin-bottom: 20px;
}

#slot-bet {
  padding: 15px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: rgba(255,255,255,0.95);
  color: var(--dark-green);
  width: 150px;
  text-align: center;
}

.slot-controls button {
  padding: 15px 30px;
  font-size: 18px;
  background: var(--metallic-orange);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-weight: bold;
}

.slot-controls button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(212, 128, 44, 0.3);
}

.slot-controls button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

#slot-result {
  text-align: center;
  min-height: 40px;
  margin-top: 20px;
}

#slot-result h2 {
  margin: 0;
  font-size: 24px;
  animation: resultPop 0.5s ease-out;
}

.inventory-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); /* Adjusted minimum width */
  gap: 20px;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.inventory-slot {
  position: relative;
  background: linear-gradient(135deg, var(--navy-blue), #0d1525);
  border: 2px solid var(--metal-gray);
  border-radius: 15px;
  padding: 15px;
  width: 150px; /* Fixed width */
  height: 150px; /* Fixed height */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  transition: all 0.3s ease;
  cursor: pointer;
  overflow: hidden; /* Prevent content overflow */
}

.inventory-slot img {
  width: 80px; /* Control image size */
  height: 80px; /* Control image size */
  object-fit: contain; /* Maintain aspect ratio */
  margin: 5px 0;
}

.inventory-slot.equipped {
  border: 3px solid var(--metallic-orange);
  box-shadow: 0 0 15px var(--metallic-orange);
  animation: equipGlow 2s infinite alternate;
}

@keyframes equipGlow {
  from {
    box-shadow: 0 0 15px var(--metallic-orange);
  }
  to {
    box-shadow: 0 0 25px var(--metallic-orange);
  }
}

/* Add equipped status indicator */
.inventory-slot.equipped::after {
  content: "EQUIPPED";
  position: absolute;
  top: 5px;
  right: 5px;
  background: var(--metallic-orange);
  color: white;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 10px;
  font-weight: bold;
}

/* Add rarity color styles */
.Common { color: #ffffff; }
.Rare { color: #4CAF50; }
.Epic { color: #9C27B0; }
.Mythic { color: #2196F3; }
.Legendary { color: #FFC107; }

/* New styles for egg overlay and hatching */
.egg-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  transition: opacity 0.5s;
}

.egg-hatching {
  position: relative;
  width: 300px;
  height: 300px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.farm-egg.shaking {
  width: 200px;
  height: 200px;
  animation: shakeEgg 0.5s infinite;
}

.hatched-pet {
  display: none;
  width: 200px;
  height: 200px;
  object-fit: contain;
  opacity: 0;
  transform: scale(0.5);
}

.hatched-pet.reveal {
  opacity: 1;
  transform: scale(1);
  transition: all 0.5s ease-out;
}

@keyframes shakeEgg {
  0%, 100% { transform: rotate(-10deg) scale(1); }
  25% { transform: rotate(15deg) scale(1.1); }
  50% { transform: rotate(-15deg) scale(0.9); }
}
</style>
</head>
<body>
<div class="sidebar">
  <a href="#home"><i class="fas fa-home"></i> Home</a>
  <a href="#wheel"><i class="fas fa-dharmachakra"></i> Wheel</a>
  <a href="#shop"><i class="fas fa-store"></i> Shop</a>
  <a href="#crates"><i class="fas fa-box"></i> Crates</a>
  <a href="#buy"><i class="fas fa-coins"></i> Buy</a>
  <a href="#slots"><i class="fas fa-clover"></i> Slots</a>
  <a href="#blackjack"><i class="fas fa-cards"></i> Blackjack</a>
  <a href="#streak"><i class="fas fa-fire"></i> Daily Streak</a>
  <a href="#inventory"><i class="fas fa-box-open"></i> Inventory</a>
</div>

<div class="content">
  <div id="home">
    <h1 class="section-title">BATTLE PASS</h1>
    <div class="battle-pass">
      <div class="battle-pass-item" onclick="unlockBattlePassItem(0)">
        <div class="level-indicator">1</div>
        <div class="item-info">
          <div class="item-emoji">üñêÔ∏è</div>
          <div class="item-details">
            <h3>High Five</h3>
            <div class="item-price">20 EC</div>
          </div>
        </div>
      </div>
      
      <div class="battle-pass-item" onclick="unlockBattlePassItem(1)">
        <div class="level-indicator">2</div>
        <div class="item-info">
          <div class="item-emoji">üëä</div>
          <div class="item-details">
            <h3>Fist Bump</h3>
            <div class="item-price">25 EC</div>
          </div>
        </div>
      </div>
      
      <div class="battle-pass-item" onclick="unlockBattlePassItem(2)">
        <div class="level-indicator">3</div>
        <div class="item-info">
          <div class="item-emoji">ü§ù</div>
          <div class="item-details">
            <h3>Hand Shake</h3>
            <div class="item-price">30 EC</div>
          </div>
        </div>
      </div>
      
      <div class="battle-pass-item" onclick="unlockBattlePassItem(3)">
        <div class="level-indicator">4</div>
        <div class="item-info">
          <div class="item-emoji">üëè</div>
          <div class="item-details">
            <h3>Pat on the Back</h3>
            <div class="item-price">35 EC</div>
          </div>
        </div>
      </div>

      <div class="battle-pass-item" onclick="unlockBattlePassItem(4)">
        <div class="level-indicator">5</div>
        <div class="item-info">
          <div class="item-emoji">üëè</div>
          <div class="item-details">
            <h3>Round of Applause</h3>
            <div class="item-price">40 EC</div>
          </div>
        </div>
      </div>

      <div class="battle-pass-item" onclick="unlockBattlePassItem(5)">
        <div class="level-indicator">6</div>
        <div class="item-info">
          <div class="item-emoji">üìñ</div>
          <div class="item-details">
            <h3>Eager Chapter 1</h3>
            <div class="item-price">45 EC</div>
          </div>
        </div>
      </div>

      <div class="battle-pass-item" onclick="unlockBattlePassItem(6)">
        <div class="level-indicator">7</div>
        <div class="item-info">
          <div class="item-emoji">üéÅ</div>
          <div class="item-details">
            <h3>Mystery Chest</h3>
            <div class="item-price">50 EC</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="welcome" class="welcome">
    <h1>WELCOME TO THE EAGER WEB</h1>
    <p>Welcome to the official Eager shop! Here you can spend your Eager Coins (EC) on various rewards and try your luck at the emoji spinner!</p>
    <div class="username-form">
      <input type="text" id="username-input" placeholder="Enter a username">
      <button onclick="checkUsername()">Begin Journey</button>
    </div>
  </div>

  <div id="main-content">
    <div id="wheel">
      <h1 class="section-title">EAGER WHEEL</h1>
      <div class="bet-container">
        <input type="number" id="bet-amount" placeholder="Bet Amount">
        <button onclick="spin()">Spin!</button>
      </div>
      <div class="emoji-spinner" id="emoji-spinner">
        <div class="emoji-box">üéâ</div>
        <div class="emoji-box">‚ùå</div>
        <div class="emoji-box">üéâ</div>
        <div class="emoji-box">‚ùå</div>
        <div class="emoji-box">üéâ</div>
      </div>
      <p id="spinner-result"></p>
    </div>

    <div id="shop">
      <h1 class="section-title">Reward Shop</h1>
      <div class="redeem-code-section">
        <h2>Redeem Gift Code</h2>
        <div class="redeem-controls">
          <input type="text" id="gift-code" placeholder="Enter Gift Code">
          <button onclick="redeemCode()">Redeem</button>
        </div>
        <div id="redeem-status"></div>
      </div>
      <div class="shop-grid">
        <div class="shop-item prestige-rank">
          <div class="emoji">üëë</div>
          <h3>VIP Rank</h3>
          <p>LETS GO</p>
          <p class="price">500 EC</p>
          <button onclick="buyItem('VIP Rank', 500)" class="rank-button">Purchase</button>
        </div>
        <div class="shop-item prestige-rank">
          <div class="emoji">üåü</div>
          <h3>MVP Rank</h3>
          <p>Basically MVP</p>
          <p class="price">1000 EC</p>
          <button onclick="buyItem('MVP Rank', 1000)" class="rank-button">Purchase</button>
        </div>
        <div class="shop-item prestige-rank">
          <div class="emoji">üßÄ</div>
          <h3>Cheese Rank</h3>
          <p>CHEESE</p>
          <p class="price">1000 EC</p>
          <button onclick="buyItem('Cheese Rank', 1000)" class="rank-button">Purchase</button>
        </div>
        <div class="shop-item prestige-rank">
          <div class="emoji">‚ö°</div>
          <h3>Eager Rank</h3>
          <p>I...Am Eager</p>
          <p class="price">2000 EC</p>
          <button onclick="buyItem('Eager Rank', 2000)" class="rank-button">Purchase</button>
        </div>
        <div class="shop-item prestige-rank">
          <div class="emoji">üòé</div>
          <h3>Chill Guy Rank</h3>
          <p>When the still water is skibidi but you're just a chill guy</p>
          <p class="price">10000 EC</p>
          <button onclick="buyItem('Chill Guy Rank', 10000)" class="rank-button">Purchase</button>
        </div>
        <div class="shop-item">
          <img src="https://freepngimg.com/thumb/egg/3-2-egg-png-picture.png" alt="Farm Egg" class="farm-egg">
          <h3>Farm Egg</h3>
          <p>Hatch a farm animal!</p>
          <p class="price">5000 EC</p>
          <button onclick="buyAndHatchEgg()">Purchase & Hatch</button>
        </div>
        <div class="shop-item">
          <img src="https://freepngimg.com/thumb/egg/3-2-egg-png-picture.png" alt="Eager Egg" class="farm-egg">
          <h3>Eager Egg</h3>
          <p>Hatch an Eager pet!</p>
          <p class="price">10000 EC</p>
          <button onclick="buyAndHatchEagerEgg()">Purchase & Hatch</button>
        </div>
      </div>
    </div>

    <div id="inventory" style="display: none;">
      <h1 class="section-title">EAGER INVENTORY</h1>
      <div class="inventory-grid">
        <!-- 50 inventory slots -->
        <!-- Will be populated by JavaScript -->
      </div>
    </div>

    <div id="crates" style="display: none;">
      <h1 class="section-title">EAGER CRATES</h1>
      <div class="crates-container">
        <div class="crate">
          <div class="emoji">üëë</div>
          <h3>VIP Crate</h3>
          <p>Win 10, 30, 100, or 400 EC!</p>
          <p class="price">100 EC</p>
          <button onclick="openCrate('vip')">Open Crate</button>
        </div>
        
        <div class="crate">
          <div class="emoji">üåü</div>
          <h3>MVP Crate</h3>
          <p>Win 50, 100, or 200 EC!</p>
          <p class="price">100 EC</p>
          <button onclick="openCrate('mvp')">Open Crate</button>
        </div>
        
        <div class="crate">
          <div class="emoji">üßÄ</div>
          <h3>Cheese Crate</h3>
          <p>Win 0 or 1000 EC!</p>
          <p class="price">100 EC</p>
          <button onclick="openCrate('cheese')">Open Crate</button>
        </div>
        
        <div class="crate">
          <div class="emoji">‚ö°</div>
          <h3>Eager Crate</h3>
          <p>Win 50-500 EC!</p>
          <p class="price">100 EC</p>
          <button onclick="openCrate('eager')">Open Crate</button>
        </div>
        
        <div class="crate">
          <div class="emoji">üòé</div>
          <h3>Chill Guy Crate</h3>
          <p>Win 95, 100, or 1000 EC!</p>
          <p class="price">100 EC</p>
          <button onclick="openCrate('chillguy')">Open Crate</button>
        </div>
      </div>
    </div>

    <div id="slots" style="display: none;">
      <h1 class="section-title">EAGER SLOTS</h1>
      <div class="slot-machine">
        <div class="slot-reels">
          <div class="slot-reel">
            <div class="reel-content">üé≤</div>
          </div>
          <div class="slot-reel">
            <div class="reel-content">üé≤</div>
          </div>
          <div class="slot-reel">
            <div class="reel-content">üé≤</div>
          </div>
        </div>
        <div class="slot-controls">
          <input type="number" id="slot-bet" placeholder="Bet Amount" min="1">
          <button onclick="spinSlots()">Spin</button>
        </div>
        <div id="slot-result"></div>
      </div>
    </div>

    <div id="blackjack" style="display: none;">
      <h1 class="section-title">EAGER BLACKJACK</h1>
      <div class="blackjack-table">
        <div class="dealer-cards">
          <h2>Dealer's Cards</h2>
          <div class="cards-container" id="dealer-cards"></div>
        </div>
        
        <div class="player-cards">
          <h2>Your Cards</h2>
          <div class="cards-container" id="player-cards"></div>
          <p id="player-total"></p>
        </div>
        
        <div class="blackjack-controls">
          <input type="number" id="blackjack-bet" placeholder="Bet Amount" min="1">
          <div class="action-buttons" style="display: none;">
            <button onclick="hit()">Hit</button>
            <button onclick="stand()">Stand</button>
          </div>
          <button id="deal-button" onclick="startBlackjack()">Deal</button>
        </div>
        
        <div id="blackjack-result"></div>
      </div>
    </div>

    <div id="buy">
      <h1 class="section-title">Buy Eager Coins</h1>
      <div class="buy-container">
        <div class="buy-option">
          <img src="https://i.postimg.cc/XvjZpgHJ/eager-coins.png">
          <span>$5.00 (500 EC)</span>
          <button onclick="buyEC(500, 5)">Buy Now</button>
        </div>
        <div class="buy-option">
          <img src="https://i.postimg.cc/VNKJMbpF/stack-of-eager-coins.png">
          <span>$10.00 (1500 EC)</span>
          <button onclick="buyEC(1500, 10)">Buy Now</button>
        </div>
        <div class="buy-option">
          <img src="https://i.postimg.cc/jSQwx1hm/chest-of-eager-coins.png">
          <span>$20.00 (3000 EC)</span>
          <button onclick="buyEC(3000, 20)">Buy Now</button>
        </div>
      </div>
    </div>

    <div id="streak" style="display: none;">
      <h1 class="section-title">DAILY STREAK</h1>
      <div class="streak-card">
        <div class="streak-info">
          <div class="streak-count" id="streak-count">0</div>
          <div class="streak-flame">üî•</div>
        </div>
        <button class="streak-button" id="streak-button" onclick="claimDailyStreak()">
          Claim Daily Reward
        </button>
        <div class="next-reward" id="next-reward"></div>
      </div>
    </div>
  </div>
</div>

<script>
const gun = Gun();
let currentUsername = localStorage.getItem('currentUsername') || '';
let balance = 100;
let battlePassProgress = 0;

// Object to store transactions
let transactions = JSON.parse(localStorage.getItem('transactions') || '[]');

// Gun DB for gift codes
let giftCodesDB = gun.get('eagerGiftCodes'); // Changed from 'giftCodes' to make it globally shared

if(currentUsername) {
  const savedBalance = localStorage.getItem(`${currentUsername}_balance`);
  if(savedBalance) {
    balance = parseInt(savedBalance);
    document.getElementById('welcome').classList.add('hidden');
    document.getElementById('main-content').classList.remove('hidden');
    document.getElementById('main-content').classList.add('slide-in');
  }
}

let inventory = [];
let equippedPets = JSON.parse(localStorage.getItem(`${currentUsername}_equippedPets`) || '[]');

function loadInventory() {
  const saved = localStorage.getItem(`${currentUsername}_inventory`);
  if (saved) {
    inventory = JSON.parse(saved);
  }
  updateInventoryUI();
}

function saveInventory() {
  localStorage.setItem(`${currentUsername}_inventory`, JSON.stringify(inventory));
}

function saveEquippedPets() {
  localStorage.setItem(`${currentUsername}_equippedPets`, JSON.stringify(equippedPets));
}

function toggleEquipPet(index) {
  const pet = inventory[index];
  if (!pet) return;
  
  // Find if any pet of the same type is already equipped
  const existingEquippedIndex = equippedPets.findIndex(p => p.name === pet.name);
  
  if (existingEquippedIndex !== -1) {
    // Unequip
    equippedPets.splice(existingEquippedIndex, 1);
  } else {
    // Equip
    if (equippedPets.length >= 2) {
      alert('You can only equip 2 pets at a time!');
      return;
    }
    equippedPets.push(pet);
  }
  
  saveEquippedPets();
  updateInventoryUI();
}

function getPetPerks(pet) {
  switch(pet.name) {
    case 'Pig': return '1% cashback';
    case 'Cow': return '3% cashback';
    case 'Chicken': return '5% cashback';
    case 'Eager': return '7% cashback';
    case 'Beager': return '8% cashback';
    case 'Gentleman Eager': return '10% cashback, 2% luck';
    case 'Black Eager': return '10% cashback, 4% luck';
    case 'Mexican Eager': return '12% cashback, 5% luck';
    case 'Anime Girl Eager': return '10% cashback, 7% luck';
    default: return 'No perks';
  }
}

function updateInventoryUI() {
  const grid = document.querySelector('.inventory-grid');
  grid.innerHTML = '';

  // Create 50 slots
  for (let i = 0; i < 50; i++) {
    const slot = document.createElement('div');
    slot.className = 'inventory-slot';
    
    if (inventory[i]) {
      const pet = inventory[i];
      const isEquipped = equippedPets.some(p => p.name === pet.name);
      
      if (isEquipped) {
        slot.classList.add('equipped');
      }
      
      slot.innerHTML = `
        <img src="${pet.image}" alt="${pet.name}">
        <div class="pet-name">${pet.name}</div>
        <div class="pet-rarity ${pet.rarity}">${pet.rarity}</div>
      `;
      
      slot.onclick = () => toggleEquipPet(i);
    }
    
    grid.appendChild(slot);
  }
}

function buyAndHatchEgg() {
  if (balance < 5000) {
    alert('Not enough EC!');
    return;
  }
  
  if (inventory.length >= 50) {
    alert('Inventory is full!');
    return;
  }

  updateBalance(balance - 5000);
  
  const overlay = document.createElement('div');
  overlay.className = 'egg-overlay';
  
  const hatchingContainer = document.createElement('div');
  hatchingContainer.className = 'egg-hatching';
  
  const egg = document.createElement('img');
  egg.src = 'https://freepngimg.com/thumb/egg/3-2-egg-png-picture.png';
  egg.className = 'farm-egg shaking';
  
  const hatchedPet = document.createElement('img');
  hatchedPet.className = 'hatched-pet';
  
  hatchingContainer.appendChild(egg);
  hatchingContainer.appendChild(hatchedPet);
  overlay.appendChild(hatchingContainer);
  document.body.appendChild(overlay);
  
  setTimeout(() => {
    const random = Math.random();
    let pet;
    
    if (random < 0.6) { // 60% chance for pig
      pet = {
        name: 'Pig',
        image: 'https://static.vecteezy.com/system/resources/previews/011/209/951/non_2x/cute-cartoon-pig-in-farm-free-png.png',
        rarity: 'Common'
      };
    } else if (random < 0.9) { // 30% chance for cow
      pet = {
        name: 'Cow',
        image: 'https://upload.wikimedia.org/wikipedia/commons/2/21/Cow_cartoon_04.svg',
        rarity: 'Rare'
      };
    } else { // 10% chance for chicken
      pet = {
        name: 'Chicken',
        image: 'https://png.pngtree.com/png-vector/20230302/ourmid/pngtree-happy-cartoon-hen-vector-png-image_6625859.png',
        rarity: 'Epic'
      };
    }
    
    egg.style.display = 'none';
    hatchedPet.src = pet.image;
    hatchedPet.style.display = 'block';
    
    setTimeout(() => {
      hatchedPet.classList.add('reveal');
    }, 100);
    
    inventory.push(pet);
    saveInventory();
    updateInventoryUI();
    
    setTimeout(() => {
      overlay.style.opacity = '0';
      setTimeout(() => {
        overlay.remove();
        alert(`üéâ Congratulations! You hatched a ${pet.rarity} ${pet.name}!`);
      }, 500);
    }, 2000);
  }, 2000);
}

function buyAndHatchEagerEgg() {
  if (balance < 10000) {
    alert('Not enough EC!');
    return;
  }
  
  if (inventory.length >= 50) {
    alert('Inventory is full!');
    return;
  }

  updateBalance(balance - 10000);
  
  const overlay = document.createElement('div');
  overlay.className = 'egg-overlay';
  
  const hatchingContainer = document.createElement('div');
  hatchingContainer.className = 'egg-hatching';
  
  const egg = document.createElement('img');
  egg.src = 'https://freepngimg.com/thumb/egg/3-2-egg-png-picture.png';
  egg.className = 'farm-egg shaking';
  
  const hatchedPet = document.createElement('img');
  hatchedPet.className = 'hatched-pet';
  
  hatchingContainer.appendChild(egg);
  hatchingContainer.appendChild(hatchedPet);
  overlay.appendChild(hatchingContainer);
  document.body.appendChild(overlay);
  
  setTimeout(() => {
    const random = Math.random();
    let pet;
    
    if (random < 0.5) { // 50% chance for Eager
      pet = {
        name: 'Eager',
        image: 'path/to/eager/image.png',
        rarity: 'Epic'
      };
    } else if (random < 0.8) { // 30% chance for Beager
      pet = {
        name: 'Beager',
        image: 'path/to/beager/image.png',
        rarity: 'Mythic'
      };
    } else if (random < 0.95) { // 15% chance for Gentleman Eager
      pet = {
        name: 'Gentleman Eager',
        image: 'path/to/gentleman/image.png',
        rarity: 'Legendary'
      };
    } else { // 5% chance for special pets
      const specialPets = [
        {
          name: 'Black Eager',
          image: 'path/to/black/image.png',
          rarity: 'Legendary'
        },
        {
          name: 'Mexican Eager',
          image: 'path/to/mexican/image.png',
          rarity: 'Legendary'
        },
        {
          name: 'Anime Girl Eager',
          image: 'path/to/anime/image.png',
          rarity: 'Legendary'
        }
      ];
      pet = specialPets[Math.floor(Math.random() * specialPets.length)];
    }
    
    egg.style.display = 'none';
    hatchedPet.src = pet.image;
    hatchedPet.style.display = 'block';
    
    setTimeout(() => {
      hatchedPet.classList.add('reveal');
    }, 100);
    
    inventory.push(pet);
    saveInventory();
    updateInventoryUI();
    
    setTimeout(() => {
      overlay.style.opacity = '0';
      setTimeout(() => {
        overlay.remove();
        alert(`üéâ Congratulations! You hatched a ${pet.rarity} ${pet.name}!`);
      }, 500);
    }, 2000);
  }, 2000);
}

// Load inventory on page load
if (currentUsername) {
  loadInventory();
}

// Other existing functions...

function loadPurchasedRanks() {
  const saved = localStorage.getItem(`${currentUsername}_ranks`);
  return saved ? JSON.parse(saved) : {};
}

function savePurchasedRanks(ranks) {
  localStorage.setItem(`${currentUsername}_ranks`, JSON.stringify(ranks));
}

function loadEquippedRank() {
  return localStorage.getItem(`${currentUsername}_equipped_rank`);
}

function saveEquippedRank(rank) {
  localStorage.setItem(`${currentUsername}_equipped_rank`, rank);
}

function updateBalance(newBalance) {
  balance = newBalance;
  localStorage.setItem(`${currentUsername}_balance`, balance);
  
  const balanceDisplay = document.createElement('div');
  balanceDisplay.style.position = 'fixed';
  balanceDisplay.style.top = '20px';
  balanceDisplay.style.right = '20px';
  balanceDisplay.style.background = 'var(--metallic-orange)';
  balanceDisplay.style.padding = '10px 20px';
  balanceDisplay.style.borderRadius = '8px';
  balanceDisplay.style.fontWeight = 'bold';
  balanceDisplay.style.zIndex = '1000';
  balanceDisplay.textContent = `Balance: ${balance} EC`;
  
  const existingBalance = document.querySelector('.balance-display');
  if (existingBalance) {
    existingBalance.remove();
  }
  
  balanceDisplay.classList.add('balance-display');
  document.body.appendChild(balanceDisplay);
}

function unlockBattlePassItem(level) {
  const prices = [20, 25, 30, 35, 40, 45, 50];
  const items = ["High Five", "Fist Bump", "Hand Shake", "Pat on the Back", 
                "Round of Applause", "The Book Eager Chapter 1", "Mystery Chest"];
  
  if (level !== battlePassProgress) {
    alert("Complete previous items first!");
    return;
  }
  
  const price = prices[level];
  
  if (balance >= price) {
    if (confirm(`Unlock ${items[level]} for ${price} EC?`)) {
      updateBalance(balance - price);
      battlePassProgress++;
      saveBattlePassProgress();
      
      // If it's the final chest
      if (level === 6) {
        const rewards = [0, 20, 40, 50, 100, 250];
        const reward = rewards[Math.floor(Math.random() * rewards.length)];
        updateBalance(balance + reward);
        alert(`You got ${reward} EC from the Mystery Chest!`);
      }
      
      // Update UI with new style
      document.querySelectorAll('.battle-pass-item').forEach((item, index) => {
        if (index < battlePassProgress) {
          item.classList.add('completed');
          item.classList.remove('locked');
        } else if (index === battlePassProgress) {
          item.classList.remove('locked');
        } else {
          item.classList.add('locked');
        }
      });
      
      alert(`Successfully unlocked ${items[level]}!`);
    }
  } else {
    alert('Not enough EC!');
  }
}

// Save battle pass progress
function saveBattlePassProgress() {
  localStorage.setItem(`${currentUsername}_battlepass`, battlePassProgress);
}

// Load battle pass progress
function loadBattlePassProgress() {
  const saved = localStorage.getItem(`${currentUsername}_battlepass`);
  if (saved) {
    battlePassProgress = parseInt(saved);
    requestAnimationFrame(() => {
      // Wait for next frame to ensure elements exist
      const items = document.querySelectorAll('.battle-pass-item');
      if (items) {
        items.forEach((item, index) => {
          if (index < battlePassProgress) {
            item.classList.add('completed');
            item.classList.remove('locked');
          } else if (index === battlePassProgress) {
            item.classList.remove('locked');
          } else {
            item.classList.add('locked');
          }
        });
      }
    });
  }
}

// Function to gift EC to users
function giftEC() {
  // Empty function to avoid errors
}

function generateGiftCode() {
  if (currentUsername !== 'EagerADMIN') return;
  
  const amount = parseInt(document.getElementById('code-amount').value);
  if (!amount || amount <= 0) {
    alert('Please enter a valid EC amount');
    return;
  }

  const code = Math.random().toString(36).substring(2, 10).toUpperCase();
  
  // Store the code with global accessibility
  giftCodesDB.get(code).put({
    amount: amount,
    active: true,
    created: new Date().toISOString(),
    createdBy: 'EagerADMIN'
  }, (ack) => {
    if (ack.err) {
      alert('Error generating code. Please try again.');
      return;
    }
    
    document.getElementById('generated-code').textContent = `Generated Code: ${code}`;
    document.getElementById('generated-code').style.color = '#4CAF50';
    document.getElementById('code-amount').value = '';
    
    // Update the active codes list
    updateActiveCodesList();
  });
}

function updateActiveCodesList() {
  const list = document.getElementById('active-codes-list');
  if (!list || currentUsername !== 'EagerADMIN') return;
  
  list.innerHTML = ''; // Clear existing list
  
  giftCodesDB.map().once((data, code) => {
    if (data && data.active) {
      const codeItem = document.createElement('div');
      codeItem.className = 'code-item';
      codeItem.innerHTML = `
        <span>${code} (${data.amount} EC)</span>
        <button onclick="deleteCode('${code}')">Delete</button>
      `;
      list.appendChild(codeItem);
    }
  });
}

function deleteCode(code) {
  if (currentUsername !== 'EagerADMIN') return;
  
  giftCodesDB.get(code).put({
    active: false,
    deletedAt: new Date().toISOString(),
    deletedBy: 'EagerADMIN'
  });
  
  updateActiveCodesList();
}

function redeemCode() {
  const code = document.getElementById('gift-code').value.toUpperCase();
  const status = document.getElementById('redeem-status');
  
  if (!code) {
    status.textContent = 'Please enter a code';
    return;
  }

  // Special case for SIGMAEAGER69
  if (code === 'SIGMAEAGER69') {
    const specialCodeKey = `${currentUsername}_SIGMAEAGER69`;
    if (localStorage.getItem(specialCodeKey)) {
      status.textContent = 'You have already redeemed this code!';
      status.style.color = '#f44336';
      return;
    }
    
    updateBalance(balance + 10000);
    status.textContent = 'üéâ SECRET CODE: You received 10,000 EC! Welcome to the elite! üéâ';
    status.style.color = '#4CAF50';
    document.getElementById('gift-code').value = '';
    return;
  }
  
  // Check if user has already redeemed this code
  const userRedemptionKey = `${currentUsername}_${code}`;
  if (localStorage.getItem(userRedemptionKey)) {
    status.textContent = 'You have already redeemed this code!';
    status.style.color = '#f44336';
    return;
  }
  
  giftCodesDB.get(code).once((giftCode) => {
    if (!giftCode || !giftCode.active) {
      status.textContent = 'Invalid or expired code';
      status.style.color = '#f44336';
      return;
    }
    
    // Add the EC amount to user's balance
    updateBalance(balance + giftCode.amount);
    
    // Mark code as redeemed for this user
    localStorage.setItem(userRedemptionKey, 'true');
    
    // Record the transaction
    status.textContent = `Successfully redeemed ${giftCode.amount} EC!`;
    status.style.color = '#4CAF50';
    document.getElementById('gift-code').value = '';
  });
}

// Updated openCrate function
function openCrate(type) {
  // First load purchased ranks
  const purchasedRanks = loadPurchasedRanks();
  
  // Check if user has the corresponding rank
  const rankMap = {
    'vip': 'VIP Rank',
    'mvp': 'MVP Rank',
    'cheese': 'Cheese Rank',
    'eager': 'Eager Rank',
    'chillguy': 'Chill Guy Rank'
  };
  
  const requiredRank = rankMap[type];
  
  if (!purchasedRanks[requiredRank]) {
    alert(`You need to purchase the ${requiredRank} to open this crate!`);
    return;
  }

  if (balance < 100) {
    alert('Not enough EC! You need 100 EC to open this crate.');
    return;
  }

  const crateElement = Array.from(document.querySelectorAll('.crate')).find(crate => 
    crate.querySelector('button').onclick.toString().includes(type)
  );
  crateElement.classList.add('opening');
  
  setTimeout(() => {
    crateElement.classList.remove('opening');
  }, 500);

  updateBalance(balance - 100);
  let reward = 0;

  switch(type) {
    case 'vip':
      const vipRewards = [10, 30, 100, 400];
      reward = vipRewards[Math.floor(Math.random() * vipRewards.length)];
      break;
    case 'mvp':
      const mvpRewards = [50, 100, 200];
      reward = mvpRewards[Math.floor(Math.random() * mvpRewards.length)];
      break;
    case 'cheese':
      reward = Math.random() < 0.5 ? 0 : 1000;
      break;
    case 'eager':
      reward = Math.floor(Math.random() * (500 - 50 + 1)) + 50;
      break;
    case 'chillguy':
      const chillRewards = [95, 100, 1000];
      reward = chillRewards[Math.floor(Math.random() * chillRewards.length)];
      break;
  }

  updateBalance(balance + reward);
  
  // Create a special alert for the reward
  const message = reward === 0 
    ? 'üò¢ Better luck next time!' 
    : `üéâ CONGRATULATIONS! üéâ\n\nYou won ${reward} EC from the ${type.toUpperCase()} Crate!`;
    
  alert(message);
}

function checkUsername() {
  const username = document.getElementById('username-input').value;
  if (!username) return;

  gun.get(`users/${username}`).once((data) => {
    if (data) {
      alert('Username already taken!');
    } else {
      gun.get(`users/${username}`).put({ username });
      currentUsername = username;
      localStorage.setItem('currentUsername', username);
      const savedBalance = localStorage.getItem(`${username}_balance`);
      if (savedBalance) {
        updateBalance(parseInt(savedBalance));
      } else {
        updateBalance(100);
      }
      document.getElementById('welcome').classList.add('hidden');
      document.getElementById('main-content').classList.remove('hidden');
      document.getElementById('main-content').classList.add('slide-in');
    }
  });
}

function showWelcomeBack() {
  if (currentUsername) {
    const welcomeBack = document.createElement('div');
    welcomeBack.className = 'welcome-back';
    
    // Add random stars
    for (let i = 0; i < 20; i++) {
      const star = document.createElement('span');
      star.className = 'stars';
      star.textContent = Math.random() > 0.5 ? '‚≠ê' : 'üíñ';
      star.style.left = Math.random() * 100 + 'vw';
      star.style.top = Math.random() * 100 + 'vh';
      star.style.animationDelay = Math.random() * 2 + 's';
      welcomeBack.appendChild(star);
    }
    
    welcomeBack.innerHTML += `
      <h1>Welcome Back ${currentUsername}! ‚≠ê</h1>
      <p>Welcome to the official Eager shop! Here you can spend your Eager Coins (EC) 
         on various rewards and try your luck at the emoji spinner! üíñ</p>
    `;
    
    document.body.appendChild(welcomeBack);
    
    setTimeout(() => {
      welcomeBack.remove();
    }, 5000);
  }
}

window.addEventListener('load', () => {
  if (currentUsername) {
    setTimeout(() => {
      loadBattlePassProgress();
      loadStreak(); // Added streak loading
      loadInventory(); // Load inventory on page load
    }, 100);
    
    showWelcomeBack();
    document.getElementById('welcome').classList.add('hidden');
    document.getElementById('main-content').classList.remove('hidden');
    document.getElementById('main-content').classList.add('slide-in');
    
    // Update rank buttons based on purchases
    const purchasedRanks = loadPurchasedRanks();
    const equippedRank = loadEquippedRank();
    
    document.querySelectorAll('.shop-item').forEach(item => {
      const rankName = item.querySelector('h3').textContent;
      const button = item.querySelector('button');
      if (purchasedRanks[rankName]) {
        button.textContent = rankName === equippedRank ? 'UNEQUIP' : 'EQUIP';
      }
    });
  } else {
    document.getElementById('main-content').classList.add('hidden');
    document.getElementById('welcome').classList.remove('hidden');
  }
});

document.querySelectorAll('.sidebar a').forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    const targetId = link.getAttribute('href').substring(1);
    
    ['home', 'wheel', 'shop', 'crates', 'buy', 'slots', 'blackjack', 'streak', 'inventory'].forEach(id => {
      const section = document.getElementById(id);
      if (section) {
        section.style.display = 'none';
      }
    });
    
    const targetSection = document.getElementById(targetId);
    if (targetSection) {
      targetSection.style.display = 'block';
      targetSection.scrollIntoView({
        behavior: 'smooth'
      });
    }
  });
});

function spin() {
  const betAmount = parseInt(document.getElementById('bet-amount').value);
  if (isNaN(betAmount) || betAmount <= 0) {
    alert('Please enter a valid bet amount!');
    return;
  }
  
  if (betAmount > balance) {
    alert('Not enough EC!');
    return;
  }

  const spinButton = document.querySelector('.bet-container button');
  spinButton.disabled = true;

  const emojis = document.querySelectorAll('.emoji-box');
  let currentIndex = 0;

  document.getElementById('spinner-result').textContent = '';

  const intervalId = setInterval(() => {
    emojis.forEach(emoji => {
      emoji.style.transform = 'scale(1)';
      emoji.style.transition = 'transform 0.2s ease';
    });
    
    emojis[currentIndex].style.transform = 'scale(1.2)';
    currentIndex = (currentIndex + 1) % emojis.length;
  }, 200);

  setTimeout(() => {
    clearInterval(intervalId);
    const result = Math.random() < 0.5;
    
    if (result) {
      updateBalance(balance + betAmount);
      document.getElementById('spinner-result').textContent = 'üéâ You won double! üéâ';
      document.getElementById('spinner-result').style.color = '#4CAF50';
    } else {
      updateBalance(balance - betAmount);
      document.getElementById('spinner-result').textContent = '‚ùå You lost everything! ‚ùå';
      document.getElementById('spinner-result').style.color = '#f44336';
    }
    
    spinButton.disabled = false;
  }, 3000);
}

function spinSlots() {
  const betAmount = parseInt(document.getElementById('slot-bet').value);
  if (isNaN(betAmount) || betAmount <= 0) {
    alert('Please enter a valid bet amount!');
    return;
  }

  if (betAmount > balance) {
    alert('Not enough EC!');
    return;
  }

  const button = document.querySelector('.slot-controls button');
  button.disabled = true;
  updateBalance(balance - betAmount);

  const emojis = ['üé≤', 'üíé', 'üé∞', '7Ô∏è‚É£', 'üçÄ', '‚≠ê', 'üí∞', 'üéÆ'];
  const reels = document.querySelectorAll('.reel-content');
  const results = [];
  
  reels.forEach((reel, index) => {
    let spins = 0;
    const finalIndex = Math.floor(Math.random() * emojis.length);
    results.push(emojis[finalIndex]);
    
    const interval = setInterval(() => {
      spins++;
      reel.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      
      if (spins > 20 + (index * 5)) {
        clearInterval(interval);
        reel.textContent = results[index];
      }
    }, 100);
  });

  setTimeout(() => {
    button.disabled = false;
    
    // Check for wins
    if (results[0] === results[1] && results[1] === results[2]) {
      // Jackpot - 5x
      const winAmount = betAmount * 5;
      updateBalance(balance + winAmount);
      document.getElementById('slot-result').innerHTML = `
        <h2 style="color: #4CAF50">JACKPOT! You won ${winAmount} EC! üéâ</h2>
      `;
    } else if (results[0] === results[1] || results[1] === results[2]) {
      // Two matching - 2x
      const winAmount = betAmount * 2;
      updateBalance(balance + winAmount);
      document.getElementById('slot-result').innerHTML = `
        <h2 style="color: #4CAF50">You won ${winAmount} EC! üéâ</h2>
      `;
    } else {
      document.getElementById('slot-result').innerHTML = `
        <h2 style="color: #f44336">Try again! üò¢</h2>
      `;
    }
  }, 3000);
}

function buyEC(amount, cost) {
  if (confirm(`Are you sure you want to spend $${cost} for ${amount} EC?`)) {
    updateBalance(balance + amount);
    alert(`Thank you for your purchase! ${amount} EC have been added to your balance.`);
  }
}

function buyItem(rankName, cost) {
  const purchasedRanks = loadPurchasedRanks();
  
  // If already purchased, handle equip/unequip
  if (purchasedRanks[rankName]) {
    const equippedRank = loadEquippedRank();
    if (equippedRank === rankName) {
      // Unequip
      saveEquippedRank(null);
      // Find button using standard JS
      const shopItem = Array.from(document.querySelectorAll('.shop-item')).find(item => 
        item.querySelector('h3').textContent === rankName
      );
      const button = shopItem && shopItem.querySelector('button');
      if (button) button.textContent = 'EQUIP';
    } else {
      // Equip
      saveEquippedRank(rankName);
      // Update all buttons
      document.querySelectorAll('.shop-item').forEach(item => {
        const itemRankName = item.querySelector('h3').textContent;
        const button = item.querySelector('button');
        if (purchasedRanks[itemRankName]) {
          button.textContent = itemRankName === rankName ? 'UNEQUIP' : 'EQUIP';
        }
      });
    }
    return;
  }

  // Handle new purchase
  if (balance >= cost) {
    if (confirm(`Are you sure you want to buy ${rankName} for ${cost} EC?`)) {
      updateBalance(balance - cost);
      
      // Save the purchase
      purchasedRanks[rankName] = true;
      savePurchasedRanks(purchasedRanks);
      
      // Automatically equip the new rank
      saveEquippedRank(rankName);
      
      // Update button text using standard JS
      const shopItem = Array.from(document.querySelectorAll('.shop-item')).find(item => 
        item.querySelector('h3').textContent === rankName
      );
      const button = shopItem && shopItem.querySelector('button');
      if (button) button.textContent = 'UNEQUIP';
      
      alert(`Successfully purchased ${rankName}!`);
    }
  } else {
    alert('Not enough EC!');
  }
}

// Blackjack functions
let deck = [];
let playerHand = [];
let dealerHand = [];
let currentBet = 0;

function createDeck() {
  deck = [];
  for (let i = 2; i <= 10; i++) {
    for (let j = 0; j < 4; j++) {
      deck.push(i);
    }
  }
// Face cards
  for (let j = 0; j < 4; j++) {
    deck.push(10); // Jack
    deck.push(10); // Queen
    deck.push(10); // King
    deck.push(11); // Ace
  }
}

function shuffleDeck() {
  for (let i = deck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
}

function drawCard() {
  return deck.pop();
}

function calculateTotal(hand) {
  let total = 0;
  let aces = 0;
  
  for (let card of hand) {
    if (card === 11) aces++;
    total += card;
  }
  
  while (total > 21 && aces > 0) {
    total -= 10;
    aces--;
  }
  
  return total;
}

function startBlackjack() {
  const betAmount = parseInt(document.getElementById('blackjack-bet').value);
  if (isNaN(betAmount) || betAmount <= 0) {
    alert('Please enter a valid bet amount!');
    return;
  }
  
  if (betAmount > balance) {
    alert('Not enough EC!');
    return;
  }
  
  currentBet = betAmount;
  updateBalance(balance - betAmount);
  
  // Reset and start new game
  createDeck();
  shuffleDeck();
  playerHand = [drawCard(), drawCard()];
  dealerHand = [drawCard(), drawCard()];
  
  // Update UI
  document.getElementById('deal-button').style.display = 'none';
  document.querySelector('.action-buttons').style.display = 'flex';
  document.getElementById('blackjack-bet').disabled = true;
  
  updateBlackjackUI();
}

function updateBlackjackUI() {
  const dealerCards = document.getElementById('dealer-cards');
  const playerCards = document.getElementById('player-cards');
  
  // Clear previous cards
  dealerCards.innerHTML = '';
  playerCards.innerHTML = '';
  
  // Show dealer's first card and hide second card
  dealerCards.innerHTML = `
    <div class="card" style="animation-delay: 0.1s">${dealerHand[0]}</div>
    <div class="card hidden" style="animation-delay: 0.2s">?</div>
  `;
  
  // Show all player cards with staggered animation
  playerHand.forEach((card, index) => {
    playerCards.innerHTML += `
      <div class="card" style="animation-delay: ${0.3 + (index * 0.1)}s">
        ${card}
      </div>
    `;
  });
  
  document.getElementById('player-total').textContent = `Total: ${calculateTotal(playerHand)}`;
}

function hit() {
  playerHand.push(drawCard());
  const total = calculateTotal(playerHand);
  
  updateBlackjackUI();
  
  if (total > 21) {
    endGame('bust');
  }
}

function stand() {
  // Dealer's turn
  while (calculateTotal(dealerHand) < 15) {
    dealerHand.push(drawCard());
  }
  
  endGame('stand');
}

function endGame(reason) {
  const dealerCards = document.getElementById('dealer-cards');
  const result = document.getElementById('blackjack-result');
  
  // Show all dealer cards with animation
  dealerCards.innerHTML = '';
  dealerHand.forEach((card, index) => {
    dealerCards.innerHTML += `
      <div class="card" style="animation-delay: ${0.1 * index}s">
        ${card}
      </div>
    `;
  });
  
  const playerTotal = calculateTotal(playerHand);
  const dealerTotal = calculateTotal(dealerHand);
  
  let message = '';
  
  if (reason === 'bust') {
    message = `Bust! You lost ${currentBet} EC!`;
  } else {
    if (dealerTotal > 21) {
      message = `Dealer bust! You won ${currentBet * 2} EC!`;
      updateBalance(balance + (currentBet * 2));
    } else if (playerTotal > dealerTotal) {
      message = `You won ${currentBet * 2} EC!`;
      updateBalance(balance + (currentBet * 2));
    } else if (playerTotal < dealerTotal) {
      message = `Dealer wins! You lost ${currentBet} EC!`;
    } else {
      message = "Push! Bet returned.";
      updateBalance(balance + currentBet);
    }
  }
  
  result.textContent = message;
  
  // Reset for next game
  document.getElementById('deal-button').style.display = 'block';
  document.querySelector('.action-buttons').style.display = 'none';
  document.getElementById('blackjack-bet').disabled = false;
}

// Streak functions
function loadStreak() {
  const lastClaim = localStorage.getItem(`${currentUsername}_lastStreak`);
  const streakCount = parseInt(localStorage.getItem(`${currentUsername}_streakCount`) || '0');
  const streakCountElement = document.getElementById('streak-count');
  const streakButton = document.getElementById('streak-button');
  const nextRewardElement = document.getElementById('next-reward');
  
  if (streakCountElement) {
    streakCountElement.textContent = streakCount;
  }
  
  if (lastClaim) {
    const lastClaimDate = new Date(lastClaim);
    const now = new Date();
    const timeDiff = now - lastClaimDate;
    const daysDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    
    if (daysDiff < 1) {
      // Already claimed today
      if (streakButton) {
        streakButton.disabled = true;
        streakButton.textContent = 'Already Claimed Today';
      }
      if (nextRewardElement) {
        const nextReward = 10 + (streakCount * 5);
        const nextClaimDate = new Date(lastClaimDate.getTime() + (24 * 60 * 60 * 1000));
        nextRewardElement.textContent = `Next Reward: ${nextReward} EC (Available ${nextClaimDate.toLocaleTimeString()})`;
      }
    } else if (daysDiff > 1) {
      // Streak broken
      localStorage.setItem(`${currentUsername}_streakCount`, '0');
      if (streakCountElement) {
        streakCountElement.textContent = '0';
      }
    }
  }
}

function claimDailyStreak() {
  const lastClaim = localStorage.getItem(`${currentUsername}_lastStreak`);
  let streakCount = parseInt(localStorage.getItem(`${currentUsername}_streakCount`) || '0');
  const now = new Date();
  
  if (lastClaim) {
    const lastClaimDate = new Date(lastClaim);
    const timeDiff = now - lastClaimDate;
    const daysDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    
    if (daysDiff < 1) {
      alert('You already claimed your daily reward today!');
      return;
    } else if (daysDiff > 1) {
      streakCount = 0;
    }
  }
  
  // Calculate reward
  const reward = 10 + (streakCount * 5);
  streakCount++;
  
  // Update storage
  localStorage.setItem(`${currentUsername}_lastStreak`, now.toISOString());
  localStorage.setItem(`${currentUsername}_streakCount`, streakCount);
  
  // Update balance
  updateBalance(balance + reward);
  
  // Update UI
  document.getElementById('streak-count').textContent = streakCount;
  document.getElementById('streak-button').disabled = true;
  document.getElementById('streak-button').textContent = 'Already Claimed Today';
  
  const nextClaimDate = new Date(now.getTime() + (24 * 60 * 60 * 1000));
  const nextReward = 10 + (streakCount * 5);
  document.getElementById('next-reward').textContent = 
    `Next Reward: ${nextReward} EC (Available ${nextClaimDate.toLocaleTimeString()})`;
  
  // Show success message
  alert(`üî• Daily Reward Claimed!\nStreak: ${streakCount} day(s)\nReward: ${reward} EC`);
}

// Add streak initialization to window.addEventListener('load')
if (currentUsername) {
  loadStreak();
}
</script>
</body></html>
